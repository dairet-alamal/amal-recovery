
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>صفحة البحث - دايرة الأمل</title>
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        input, button {
            padding: 10px;
            font-size: 16px;
            margin: 10px;
        }
        .post {
            background-color: #222;
            padding: 15px;
            margin: 10px;
            border-radius: 10px;
            text-align: right;
        }
    </style>
    <script type="module">
        // Firebase imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";
        import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore.js";

        const firebaseConfig = {
            apiKey: "AIzaSyANAmBZ2ySOP6hcVMZ2zfu8PsnXnHqZbOA",
            authDomain: "amal-recovery.firebaseapp.com",
            projectId: "amal-recovery",
            storageBucket: "amal-recovery.appspot.com",
            messagingSenderId: "1082715046722",
            appId: "1:1082715046722:web:d1a116cc70f2276f513edb",
            measurementId: "G-Z5D7GQ860S"
        };

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);

        async function searchPosts() {
            const query = document.getElementById("searchBox").value.toLowerCase();
            const resultsDiv = document.getElementById("results");
            resultsDiv.innerHTML = "";

            const snapshot = await getDocs(collection(db, "posts"));
            snapshot.forEach(doc => {
                const data = doc.data();
                const matches =
                    (!query || 
                    (data.type && data.type.toLowerCase().includes(query)) ||
                    (data.plate && data.plate.toLowerCase().includes(query)) ||
                    (data.chassis && data.chassis.toLowerCase().includes(query)));

                if (matches) {
                    resultsDiv.innerHTML += `
                        <div class="post">
                            <strong>النوع:</strong> ${data.type || "غير محدد"}<br>
                            <strong>اللون:</strong> ${data.color || "غير محدد"}<br>
                            <strong>رقم اللوحة:</strong> ${data.plate || "غير متوفر"}<br>
                            <strong>رقم الشاسيه:</strong> ${data.chassis || "غير متوفر"}<br>
                            ${data.fb_link ? `<a href="${data.fb_link}" target="_blank">رابط منشور فيسبوك</a><br>` : ""}
                            ${data.found ? "<span style='color: lime;'>✅ تم الاسترداد</span>" : ""}
                        </div>`;
                }
            });
        }

        window.onload = () => {
            document.getElementById("searchBtn").onclick = searchPosts;
            searchPosts();
        };
    </script>
</head>
<body>
    <h1>البحث عن السيارات</h1>
    <input type="text" id="searchBox" placeholder="ابحث باللون، اللوحة، النوع...">
    <button id="searchBtn">بحث</button>
    <div id="results"></div>
</body>
</html>
